<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewpot" content="width=device-width , initial-scale=1.0" />
    <link rel="stylesheet" href="css/main.css" />
    <script src="js/current-header.js" defer></script>
    <script src="../js/current-header.js" defer></script>
    <script src="https://www.gstatic.com/firebasejs/ui/6.1.0/firebase-ui-auth__ja.js"></script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.1.0/firebase-ui-auth.css" />
    <!--<script src="/__/firebase/7.16.0/firebase-app.js"></script> 
    <script src="/__/firebase/7.16.0/firebase-auth.js"></script> 
    <script src="/__/firebase/init.js"></script>--> 
    <title>子供アプリ</title>
    <style>
      .logo{
        display: flex;
        justify-content: center;
        margin: 0 auto 0;
        height: 398px;
        width: 450px;
      }
      .logo img{
        width: 100%;
        height: 100%;
      }
      .text{
        display: flex;
        justify-content: center;
        margin-top: 40px;
      }
    </style>
  </head>
  <body>
    <main>
      <div class="logo">
        <img src="ui_image/logo.png" alt="logo" title="logo">
      </div>
      <div class="text">
        <h3>以下のいづれかの方法でログインしてください。</h3>
      </div>
      <div class="auth" id="auth" lang="en"></div>
    </main>
    <script src="/__/firebase/7.16.0/firebase-app.js"></script> 
    <script src="/__/firebase/7.16.0/firebase-auth.js"></script> 
    <script src="/__/firebase/init.js"></script> 
    <script type="text/javascript">

      /*
      Firebase Authentcation を使った認証サンプル 01
      Firebase Authentication UI を使い、サインイン用のUIを生成
      ポップアップウィンドウで認証画面を表示、サインイン後元の画面に移動
      サインアウト ボタンと、Googleの表示名をウェルカムメッセージとして表示
      サインアウト 用の関数「signOut」を定義
      */

      const ui = new firebaseui.auth.AuthUI(firebase.auth());
      const uiConfig = {
      callbacks: {
        signInSuccessWithAuthResult: function(authResult, redirectUrl) {
        window.location.href = "home.html";
        return true;
        },
        },
      signInFlow: 'popup',
      //signInSuccessUrl: 'auth-sample01.html',
      //signInSuccessWithAuthResult: 
      /*signInOptions: [
        firebase.auth.GoogleAuthProvider.PROVIDER_ID,
      ],*/
      //tosUrl: 'sample01.html',
      //privacyPolicyUrl: 'auth-sample01.html'
      };

      ui.start('#auth', uiConfig);

      ui.start('#firebaseui-auth-container', {
        signInOptions: [
          firebase.auth.EmailAuthProvider.PROVIDER_ID,
          firebase.auth.GoogleAuthProvider.PROVIDER_ID
        ],
        // Other config options...
      });

      /*
      firebase.auth().onAuthStateChanged(user => {
        if (user) {
            const signOutMessage = `
            <p>Hello, ${user.displayName}!<\/p>
            <button type="submit"  onClick="signOut()">サインアウト<\/button>
            `;
            document.getElementById('auth').innerHTML =  signOutMessage;
            console.log('ログインしています');
        } 
      });
      */
      /*
      function signOut() {
      firebase.auth().onAuthStateChanged(user => {
        firebase
          .auth()
          .signOut()
          .then(() => {
            console.log('ログアウトしました');
            location.reload();
          })
          .catch((error) => {
            console.log(`ログアウト時にエラーが発生しました (${error})`);
          });
        });
      }
      }
      */
    </script>
  </body>
</html>