<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/main.css" />

    <!-- Firebase SDKをCDNから読み込む (compat バージョン) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>

    <script>
      // Firebase 初期化設定
      const firebaseConfig = {
        apiKey: "AIzaSyAqFYLZnIX-K_BTnl2eVbwyyol2WIYXTr8",
        authDomain: "apps-for-children-b2c4a.firebaseapp.com",
        projectId: "apps-for-children-b2c4a",
        storageBucket: "apps-for-children-b2c4a.appspot.com",
        messagingSenderId: "116966769056",
        appId: "1:116966769056:web:e523390f30fc7f0c0aa4c5",
        measurementId: "G-14FP9LRRQP"
      };

      // Firebase 初期化
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();
      const auth = firebase.auth();
    </script>
    <!-- Firebase UI for Authentication -->
    <script src="https://www.gstatic.com/firebasejs/ui/6.1.0/firebase-ui-auth__ja.js"></script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.1.0/firebase-ui-auth.css" />

    <title>子供アプリ</title>
    <style>
      .logo {
        display: flex;
        justify-content: center;
        margin: 0 auto 0;
        height: 400px;
        width: 400px;
      }
      .logo img {
        width: 100%;
        height: 100%;
      }
      .text {
        display: flex;
        justify-content: center;
        margin-top: 40px;
      }
      .home {
        display: flex;
        justify-content: center;
        margin-bottom: 2vh;
        size: 5vh;
      }
    </style>
  </head>
  <body>
    <main>
      <div class="logo">
        <img src="./ui_image/logo.png" alt="logo" title="logo">
      </div>
      <div class="text">
        <h3>以下のいずれかの方法でログインしてください。</h3>
      </div>
      <div id="firebaseui-auth-container"></div>
    </main>

    <script type="text/javascript">
      auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL) .then(() => {
        const ui = new firebaseui.auth.AuthUI(auth);
        const uiConfig = {
          callbacks: {
            signInSuccessWithAuthResult: function(authResult, redirectUrl) {
              // サインイン後にリダイレクトする
              window.location.href = "home.html";
              return false; // 自動リダイレクトは行わない
            }
          },
          signInFlow: 'popup',
          signInOptions: [
            firebase.auth.EmailAuthProvider.PROVIDER_ID,
            firebase.auth.GoogleAuthProvider.PROVIDER_ID
          ],
        };
        ui.start('#firebaseui-auth-container', uiConfig);
      })
      .catch(error => {
        console.error('エラーが発生しました:', error);
      });
      // FirebaseUIの初期化と設定
    </script>
  </body>
</html>